# Keyboard Date Input

[EN](./README.md) / JA

## 概要
`keyboard-date-input` は、キーボードで日付や月を入力しやすくする React コンポーネントライブラリです。書式エラーを防ぎながら、シンプルに日付を入力できます。

現在は、日付の形式として `YYYY/MM/DD`、月の形式として `YYYY/MM` をサポートしています。（西暦は 1000〜9999 のみ対応）

## 使い方
### パッケージのインストール
1. npm を使用してパッケージをインストールします：
   ```bash
   npm install keyboard-date-input
   ```

### プリセット入力を使う
1. プリセットの入力コンポーネントをインポートします：
   ```javascript
   import { DateInput, MonthInput } from 'keyboard-date-input';
   ```

2. アプリケーションでコンポーネントを使用します：
   ```jsx
   <DateInput
     value={dateValue}
     onChange={setDateValue}
     className="date-input"
   />
   ```

### カスタム入力を使う
1. カスタム入力用の関数をインポートします：
   ```javascript
   import { handleDateChange, handleKeyPress } from 'keyboard-date-input';
   ```

2. `handleDateChange` または `handleMonthChange` を `onChange` に、`handleKeyPress` を `onKeyDown` に設定します：
   ```jsx
   <YourInputComponent
     onChange={handleDateChange}
     onKeyDown={handleKeyPress}
   />
   ```

### API
- `DateInput`: 日付入力用の React コンポーネント。
  - HTMLInput 要素と同じ props を受け取ります。
  - `YYYY/MM/DD` 形式の日付入力を可能にします。
- `MonthInput`: 月入力用の React コンポーネント。
  - HTMLInput 要素と同じ props を受け取ります。
  - `YYYY/MM` 形式の月入力を可能にします。
- `handleDateChange(event)`: 日付入力の変更を処理します。`onChange` ハンドラとして設定してください。
  - `event`: 入力イベント。
  - 戻り値は `undefined`。
- `handleMonthChange(event)`: 月入力の変更を処理します。`onChange` ハンドラとして設定してください。
  - `event`: 入力イベント。
  - 戻り値は `undefined`。
- `handleKeyPress(event)`: 日付または月のキー入力を処理します。`onKeyDown` ハンドラとして設定してください。
  - `event`: keydown イベント。
  - 戻り値は `undefined`。

## 仕様
### 基本
- 数字のみが入力可能
- 数字以外の文字入力は無視される
- 初回入力モードと編集モードがある
### 初回入力モード
- 初回入力モードでは、最初の数字が入力されると自動的に次の単位(年->月、月->日)に移動
- 自動的に"/"が挿入される
- つぎのステップに分かれている
  - 年の入力
  - 月の入力
  - 日の入力
#### 年の入力
- 年は4桁で入力
- 最初の4桁の数字が入力されると月の入力に移行
##### バックスペースによる削除
- バックスペースキーで1文字ずつ削除できる（ネイティブの削除と同じ挙動）
##### カーソル移動
- 月が入力されていない場合、キーボードの矢印キーを押してもカーソルは移動しない
- 月が入力されている場合、右矢印を押すと、月の入力に移行する。日が入力されていない場合、挙動は「初回入力モード」「月の入力」になる。日が入力されている場合、挙動は「編集モード」「月の編集」になる。
#### 月の入力
- 1文字目
  - 0の入力は無視する
  - 3〜9の数字が入力された場合
    - 年の末尾に"/"がない場合は自動挿入する
    - 入力された数値に対して0パティングを行う。("yyyy/03","yyyy/09"など)
    - 日の入力に移行する
  - 1が入力された場合
    - 年の末尾に"/"がない場合は自動挿入する
    - 入力された数値に対して0パティングを行う。（"yyyy/01"となる）
    - 日の入力に移行せずに2文字目の入力をまつ
- ２文字目
  - 3〜9の数字が入力されると"01"の後ろに"/"を自動挿入し、入力された3-9の数値を日の入力として扱う（つまり、表示は"yyyy/01/03"のようになる）
  - 0,1または2が入力されると、"yyyy/10"や"yyyy/12"となり、日の入力に移行
##### バックスペースによる削除
- 月の入力中、バックスペースキーで1文字ずつ削除できる
  - 1文字目の数字が削除された場合、年の入力に戻る
  - 2文字目の数字が削除された場合、1文字目の数字のみが残る
##### カーソル移動
- 左矢印を押した場合、カーソルは年入力位置に移動する。このときの年の入力の挙動は「編集モード」「年の編集」と同じになる。
- 日が入力されている場合、右矢印を押すと、日の入力に移行する。このときの日の入力の挙動は「初回入力モード」「日の入力」と同じになる。
#### 日の入力
- 1文字目
  - 0の入力は無視する
  - 1-9の数値が入力された場合
    - 月の末尾に"/"がない場合は自動挿入する
    - 自動的に0パティングを行う。("yyyy/mm/01","yyyy/mm/09"など)
- ２文字目
  - 0-9の数字が入力されたとき、1文字目の数字と組み合わせて、月の最大日数と比較する
    - 月の最大日数を超える場合、入力は無視される
    - 月の最大日数以下の場合、1,2文字目を組み合わせた数値を日の値とし、編集モードに移行する
##### バックスペースによる削除
- バックスペースキーを押すと、日部分が"00"となる
##### カーソル移動
- 日の入力中に左矢印を押した場合、カーソルは月の入力位置に移動する。このときのキー入力の挙動は「編集モード」「月の編集」に同じとなる。
### 編集モード
- 入力値が"yyyy/mm/dd"の形式を持つ時、編集モードとなる
#### 年の編集
- "yyyy|/mm/dd"の"|"の位置にカーソルがあるとき(年の入力位置にあるとき)、年の編集となる
- 数値を入力すると、4桁目が押し出され、3桁目が4桁目に、2桁目が3桁目に、1桁目が2桁目に移動する。入力値が1桁目になる。
##### バックスペースによる削除
- バックスペースを押すと、年部分が"0000"となる
##### カーソル移動
- 右矢印を押すと、カーソルは月の入力位置に移動する。このときのキー入力の挙動は「編集モード」「月の編集」となる。
#### 月の編集
- "yyyy/mm|/dd"の"|"の位置にカーソルがあるとき(月の入力位置にあるとき)、月の編集となる
- ０が入力されたとき
  - 入力時の月の値が"01"の場合、"10"に変更する
  - 入力時の月の値が"01"ではない場合、入力を無視する
- 1が入力されたとき
  - 入力時の月の値が"01"または"11"の場合、"11"に変更する
  - 入力時の月の値が"01"または"11"ではない場合、"01"に変更する
- 2が入力されたとき
  - 入力時の月の値が"01"または"11"の場合、"12"に変更する
  - 入力時の月の値が"01"または"11"ではない場合、"02"に変更する
- 3〜9の数字が入力された場合
  - 入力された数値に対して0パティングを行ったものを月の値とする
##### バックスペースによる削除
- バックスペースを押すと、月部分が"00"となる
##### カーソル移動
- 左矢印を押すと、カーソルは年の入力位置に移動する。このときのキー入力の挙動は「編集モード」「年の編集」となる。
- 右矢印を押すと、カーソルは日の入力位置に移動する。このときのキー入力の挙動は「編集モード」「日の編集」となる。
#### 日の編集
- "yyyy/mm/dd|"の"|"の位置にカーソルがあるとき(日の入力位置にあるとき)、日の編集となる
- 入力時の日の値の1桁目と入力された数値を組み合わせた数値を、月の最大日数と比較する
  - 月の最大日数を超える場合、入力は無視される
  - 月の最大日数以下の場合、1,2文字目を組み合わせた数値を日の値とし、編集モードに移行する
  - 例:
    - 値"01"に"0"を入力: "01"
    - 値"01"に"1"を入力: "11"
    - 値"10"に"3"を入力: "03"
    - 値"11"に"0"を入力: "10"
    - 値"12"に"3"を入力: "23"
    - 値"31"に"9"を入力: "09"
##### バックスペースによる削除
- バックスペースを押すと、日部分が"00"となる
## ライセンス
MIT License